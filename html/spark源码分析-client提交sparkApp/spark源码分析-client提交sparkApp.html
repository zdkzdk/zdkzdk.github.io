<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 15.1.0.0" /><title></title></head><body><div><h2 style="margin:0pt 0pt 6pt 14.15pt; text-indent:0pt"><span style="font-family:等线; font-size:14pt; font-style:normal">1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">client</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">提交</span><span style="font-family:等线; font-size:11pt; font-weight:bold">app</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">，</span><span style="font-family:等线; font-size:11pt; font-weight:bold">master</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">启动</span><span style="font-family:等线; font-size:11pt; font-weight:bold">driver</span></h2><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">图</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:31.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.001.jpeg" width="1029" height="870" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:31.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.002.jpeg" width="716" height="834" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">Master</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">、</span><span style="font-family:等线; font-size:11pt; font-weight:bold">Worker</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">、</span><span style="font-family:等线; font-size:11pt; font-weight:bold">SparkSubmit</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">都是</span><span style="font-family:等线; font-size:11pt; font-weight:bold">deploy</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">包下</span></h3><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">在</span><span style="font-family:等线; font-size:11pt; font-weight:bold">client</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">提交时，也就是执行</span><span style="font-family:等线; font-size:11pt; font-weight:bold">spark</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">submit</span><span style="font-family:等线; font-size:11pt; font-weight:bold">  </span><span style="font-family:等线; font-size:11pt; font-weight:bold">-xxx</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">-xxx</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">时，</span><span style="font-family:等线; font-size:11pt; font-weight:bold">client</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">会启动一个进程叫</span><span style="font-family:等线; font-size:11pt; font-weight:bold">SparkSubmit</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">，会执行一个类的</span><span style="font-family:等线; font-size:11pt; font-weight:bold">main</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:63pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.003.png" width="736" height="29" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">处理参数，是否打印参数的信息，根据不同</span><span style="font-family:等线; font-size:11pt; font-weight:bold">action</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">执行不同方法，默认为</span><span style="font-family:等线; font-size:11pt; font-weight:bold">SUBMIT</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:52.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.004.png" width="406" height="184" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:52.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.005.png" width="660" height="68" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.5</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">prepareSubmitEnvironment</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">准备提交的环境，里面会设置包括集群管理器在内的多种运行设置，之后会把设置封装为一个</span><span style="font-family:等线; font-size:11pt; font-weight:bold">Tuple4</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">，第三个元素</span><span style="font-family:等线; font-size:11pt; font-weight:bold">childMainClass</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">会根据</span><span style="font-family:等线; font-size:11pt; font-weight:bold">master</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">url</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">设置启动类，如果是</span><span style="font-family:等线; font-size:11pt; font-weight:bold">yarn</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">cluster</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">模式，就设置为</span><span style="font-family:等线; font-size:11pt; font-weight:bold">org.</span><span style="font-family:等线; font-size:11pt; font-weight:bold">apache.spark</span><span style="font-family:等线; font-size:11pt; font-weight:bold">.deploy.yarn.Client</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:52.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.006.png" width="493" height="166" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:52.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.007.png" width="563" height="201" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:52.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.008.png" width="720" height="75" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.6</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">doRunMain</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">-</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">runMain</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.6.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">通过反射创建类，</span><span style="font-family:等线; font-size:11pt">chidlMainClass</span><span style="font-family:宋体; font-size:11pt">转为</span><span style="font-family:等线; font-size:11pt">mainClass</span></h4><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:73.5pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.009.png" width="468" height="75" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.6.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">将</span><span style="font-family:等线; font-size:11pt">mainClass </span><span style="font-family:宋体; font-size:11pt">映射成</span><span style="font-family:等线; font-size:11pt">SparkApplication</span><span style="font-family:宋体; font-size:11pt">对象</span></h4><p style="line-height:10.5pt; margin:7.8pt 0pt 7.8pt 42pt; text-indent:21pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.010.png" width="814" height="70" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.7</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">执行</span><span style="font-family:等线; font-size:11pt; font-weight:bold">app</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">的</span><span style="font-family:等线; font-size:11pt; font-weight:bold">start</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">方法，创建</span><span style="font-family:等线; font-size:11pt; font-weight:bold">RPC</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">环境，把</span><span style="font-family:等线; font-size:11pt; font-weight:bold">client</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">对应的</span><span style="font-family:等线; font-size:11pt; font-weight:bold">EndPoint</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">注册到</span><span style="font-family:等线; font-size:11pt; font-weight:bold">RPC</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">环境中</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt 7.8pt 42pt; text-indent:21pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.011.png" width="454" height="66" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.012.png" width="713" height="158" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.7.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">ClientEndpoint</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">onStart</span><span style="font-family:宋体; font-size:11pt">方法，将</span><span style="font-family:等线; font-size:11pt">DriverWarpper</span><span style="font-family:宋体; font-size:11pt">封装到</span><span style="font-family:等线; font-size:11pt">Command</span><span style="font-family:宋体; font-size:11pt">中，然后再封装到</span><span style="font-family:等线; font-size:11pt">driverDescription</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:宋体; font-size:11pt">然后向</span><span style="font-family:等线; font-size:11pt">Master</span><span style="font-family:宋体; font-size:11pt">申请启动</span><span style="font-family:等线; font-size:11pt">Driver,Master</span><span style="font-family:宋体; font-size:11pt">中的</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">receiveAndReply </span><span style="font-family:宋体; font-size:11pt">方法会接收此请求消息</span></h4><p style="line-height:10.5pt; margin:7.8pt 0pt 7.8pt 42pt; text-indent:21pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.013.png" width="699" height="249" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 28.35pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.8</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">maser</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">接收到请求后</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">先创建一个</span><span style="font-family:等线; font-size:11pt">driver</span><span style="font-family:宋体; font-size:11pt">对象</span></h4><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:63pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.014.png" width="617" height="301" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">执行</span><span style="font-family:等线; font-size:11pt">schedule</span><span style="font-family:宋体; font-size:11pt">，也就是调度。先打散</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">，遍历</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">，判断当前</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">能否启动</span><span style="font-family:等线; font-size:11pt">driver==</span><span style="font-family:宋体; font-size:11pt">》</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">的选择是随机的。最后</span><span style="font-family:宋体; font-size:11pt">启动启动</span><span style="font-family:等线; font-size:11pt">driver</span><span style="font-family:宋体; font-size:11pt">。</span></h4><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:63pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.015.png" width="944" height="560" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">定好</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">后，执行</span><span style="font-family:等线; font-size:11pt">launchDriver</span><span style="font-family:宋体; font-size:11pt">，给</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">发送消息启动</span><span style="font-family:等线; font-size:11pt">driver</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">RPC</span><span style="font-family:宋体; font-size:11pt">环境中的</span><span style="font-family:等线; font-size:11pt">receive</span><span style="font-family:宋体; font-size:11pt">会一直处于阻塞状态监听是否有消息发来</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 56.7pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">driver.start</span><span style="font-family:宋体; font-size:11pt">启动的就是前面</span><span style="font-family:等线; font-size:11pt">command</span><span style="font-family:宋体; font-size:11pt">中封装的</span><span style="font-family:等线; font-size:11pt">mainClass</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">command</span><span style="font-family:宋体; font-size:11pt">是用来封装</span><span style="font-family:等线; font-size:11pt">submit</span><span style="font-family:宋体; font-size:11pt">命令行信息的对象。</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:63pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.016.png" width="645" height="305" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 42.55pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">执行</span><span style="font-family:等线; font-size:11pt">driver.start</span><span style="font-family:宋体; font-size:11pt">。</span><span style="font-family:等线; font-size:11pt">driver</span><span style="font-family:宋体; font-size:11pt">用</span><span style="font-family:等线; font-size:11pt">DriverWrapper</span><span style="font-family:宋体; font-size:11pt">包装，</span><span style="font-family:等线; font-size:11pt">DriverWrapper</span><span style="font-family:宋体; font-size:11pt">会真正执行提交的</span><span style="font-family:等线; font-size:11pt">jar</span><span style="font-family:宋体; font-size:11pt">中的</span><span style="font-family:等线; font-size:11pt">main</span><span style="font-family:宋体; font-size:11pt">，也就是执行提交的任务。开始</span><span style="font-family:等线; font-size:11pt">new</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">Spr</span><span style="font-family:等线; font-size:11pt">kConf</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">SparkContext</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 56.7pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">driver</span><span style="font-family:宋体; font-size:11pt">中的</span><span style="font-family:等线; font-size:11pt">mainClass</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">client</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">mainClass</span><span style="font-family:宋体; font-size:11pt">不是一回事</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:63pt"><img src="eafc24e4-638f-4de3-85e9-5c22aa27fc04.017.png" width="792" height="244" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 56.7pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">此时会有疑问，</span><span style="font-family:等线; font-size:11pt">master</span><span style="font-family:宋体; font-size:11pt">、</span><span style="font-family:等线; font-size:11pt">worker</span><span style="font-family:宋体; font-size:11pt">、</span><span style="font-family:等线; font-size:11pt">client</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">EndPoint</span><span style="font-family:宋体; font-size:11pt">都注册</span><span style="font-family:宋体; font-size:11pt">了，</span><span style="font-family:等线; font-size:11pt">driver</span><span style="font-family:宋体; font-size:11pt">的呢？要在</span><span style="font-family:等线; font-size:11pt">new</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">SparkContext</span><span style="font-family:宋体; font-size:11pt">时才注册</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></div></body></html>