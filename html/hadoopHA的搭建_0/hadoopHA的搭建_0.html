<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 15.1.0.0" /><title></title></head><body><div><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:20.75pt"><span style="font-family:等线; font-size:10.5pt">hadoop的HA分为hdfs的和yarn的</span></p><h2 style="margin:0pt 0pt 6pt 20.75pt; text-indent:0pt"><span style="font-family:等线; font-size:14pt; font-style:normal">1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">hdfs</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">HA</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">搭建</span></h2><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">src</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.1.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hadoop</span><span style="font-family:宋体; font-size:11pt">只会读取安装目录</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">/etc/hadoop</span><span style="font-family:宋体; font-size:11pt">中</span><span style="font-family:宋体; font-size:11pt">的配置</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">将这个</span><span style="font-family:等线; font-size:11pt">hadoop</span><span style="font-family:宋体; font-size:11pt">复制为</span><span style="font-family:等线; font-size:11pt">hadoop-full</span><span style="font-family:宋体; font-size:11pt">，使用</span><span style="font-family:等线; font-size:11pt">hadoop</span><span style="font-family:宋体; font-size:11pt">文件夹进行</span><span style="font-family:等线; font-size:11pt">HA</span><span style="font-family:宋体; font-size:11pt">配置</span></h5><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.1.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">HA</span><span style="font-family:宋体; font-size:11pt">本质就是设置多个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">，通过第三方的文件系统来实现</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">数据的同步。如果想要自动实现</span><span style="font-family:等线; font-size:11pt">AS</span><span style="font-family:宋体; font-size:11pt">切换，还要加上</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">集群和</span><span style="font-family:等线; font-size:11pt">zkFC</span><span style="font-family:宋体; font-size:11pt">进程。</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">配置分</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">地址，</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">地址</span></h6><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">之间，</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">的通讯</span></h6><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[3]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">自动故障转移的开启</span></h6><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.1.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><a style="color:#0563c1" href="https://www.jianshu.com/p/70ae01424d99"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://www.jianshu.com/p/70ae01424d99</span></a><span style="font-family:等线; font-size:11pt">  </span><a style="color:#0563c1" href="https://segmentfault.com/u/dreamtecher/articles"><span style="color:#0563c1; font-family:等线; font-size:11pt; text-decoration:underline">https://segmentfault.com/u/dreamtecher/articles</span></a></h4><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">节点规划</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.2.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">ZK</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">JNN</span><span style="font-family:宋体; font-size:11pt">都是集群，</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">有</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个，要由</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">决定谁是</span><span style="font-family:等线; font-size:11pt">Active</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">zkfc</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">要在同一个物理节点</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:42.15pt"><tr><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:3.75pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">&#xa0;</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:34.8pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">N</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">N1</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">N</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">N2</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">D</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">N</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">Z</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">K</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">Z</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">KFC</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.5pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">J</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">NN</span></p></td></tr><tr><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:3.75pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">node</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">101</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:34.8pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.5pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td></tr><tr><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:3.75pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">n</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">ode102</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:34.8pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.5pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td></tr><tr><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:3.75pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">n</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">ode103</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:34.8pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="background-color:#f2f2f2; border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.5pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td></tr><tr><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:3.75pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt; font-weight:bold">n</span><span style="font-family:等线; font-size:10.5pt; font-weight:bold">ode104</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:34.8pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">√</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.45pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td><td style="border-bottom-color:#bfbfbf; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#bfbfbf; border-left-style:solid; border-left-width:0.75pt; border-right-color:#bfbfbf; border-right-style:solid; border-right-width:0.75pt; border-top-color:#bfbfbf; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:48.5pt"><p style="line-height:10.5pt; margin:7.8pt 0pt; text-align:center"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></td></tr></table><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.2.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">实际中</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">都是独享节点的。</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">因为</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">用的很多</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">实际公司中集群节点数量至少</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">位数，因为</span><span style="font-family:宋体; font-size:11pt">光独立</span><span style="font-family:宋体; font-size:11pt">功能的节点就好几个。</span></h5><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">HA</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">手动故障转移</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.3.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">左侧</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">QJM</span><span style="font-family:宋体; font-size:11pt">就是</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">，也支持</span><span style="font-family:等线; font-size:11pt">NFS</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:52.5pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.001.png" width="203" height="137" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.3.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">core-site.xml</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:63.3pt"><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:404pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&lt;configuration&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">把</span><span style="font-family:等线; font-size:11pt">两个</span><span style="font-family:等线; font-size:11pt">NameNode）的地址组装</span><span style="font-family:等线; font-size:11pt">成一个集群mycluster</span><span style="font-family:等线; font-size:11pt"> --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;</span><span style="font-family:等线; font-size:11pt">fs.defaultFS</span><span style="font-family:等线; font-size:11pt">&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">        </span><span style="width:17.89pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;hdfs://mycluster&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 指定hadoop运行时产生文件的存储目录 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;/opt/ha/hadoop-2.7.2/data/tmp&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&lt;/configuration&gt;</span></p></td></tr></table><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">定义系统入口</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">fs.defaultFS</span><span style="font-family:宋体; font-size:11pt">是定义整个</span><span style="font-family:等线; font-size:11pt">hadoop</span><span style="font-family:宋体; font-size:11pt">系统对外暴露的入口，但现在</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">有</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个，所以要设置</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个都为系统的入口，在</span><span style="font-family:Consolas; font-size:11pt">fs.defaultFS</span><span style="font-family:宋体; font-size:11pt">种</span><span style="font-family:宋体; font-size:11pt">设置</span><span style="font-family:宋体; font-size:11pt">数组的名字，然后在</span><span style="font-family:等线; font-size:11pt">hdfs</span><span style="font-family:宋体; font-size:11pt">设置元素以及元素的</span><span style="font-family:等线; font-size:11pt">rpc</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">http</span><span style="font-family:宋体; font-size:11pt">套接字</span></h6><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.3.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hdfs-site.xml</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:63.3pt"><tr style="height:1142.95pt"><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:571.9pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&lt;configuration&gt;</span></p><p style="line-height:11pt; margin:0pt; text-indent:21pt"><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;</span><span style="font-family:等线; font-size:11pt">dfs.replication</span><span style="font-family:等线; font-size:11pt">&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;2&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 完全分布式集群名称 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;</span><span style="font-family:等线; font-size:11pt">dfs.nameservices</span><span style="font-family:等线; font-size:11pt">&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;mycluster&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 集群中NameNode节点都有哪些 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.</span><span style="font-family:等线; font-size:11pt">ha.namenodes</span><span style="font-family:等线; font-size:11pt">.mycluster&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;nn</span><span style="font-family:等线; font-size:11pt">1,nn</span><span style="font-family:等线; font-size:11pt">2&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> nn1的RPC通信地址 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.namenode.rpc-address.mycluster.nn1&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;</span><span style="font-family:等线; font-size:11pt"> node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">1</span><span style="font-family:等线; font-size:11pt">:9000&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> nn2的RPC通信地址 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.namenode.rpc-address.mycluster.nn2&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:等线; font-size:11pt">:9000&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> nn1的http通信地址 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.namenode.http-address.mycluster.nn1&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;</span><span style="font-family:等线; font-size:11pt"> node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">1</span><span style="font-family:等线; font-size:11pt">:50070&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> nn2的http通信地址 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.namenode.http-address.mycluster.nn2&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;</span><span style="font-family:等线; font-size:11pt"> node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:等线; font-size:11pt">:50070&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 指定NameNode元数据在JournalNode上的存放位置 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;value&gt;qjournal://</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">1</span><span style="font-family:等线; font-size:11pt">:8485;</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:等线; font-size:11pt">:8485;</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">10</span><span style="font-family:等线; font-size:11pt">3</span><span style="font-family:等线; font-size:11pt">:8485/mycluster&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 声明journalnode服务器存储目录--&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;/opt/</span><span style="font-family:等线; font-size:11pt">module</span><span style="font-family:等线; font-size:11pt">/hadoop-2.7.2/data/jn&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;!--</span><span style="color:#ff0000; font-family:等线; font-size:11pt"> 配置隔离机制，即同一时刻只能有一台服务器对外响应 --&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;name&gt;dfs.</span><span style="color:#ff0000; font-family:等线; font-size:11pt">ha.fencing</span><span style="color:#ff0000; font-family:等线; font-size:11pt">.methods&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;value&gt;sshfence&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#ff0000; font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;!--</span><span style="color:#ff0000; font-family:等线; font-size:11pt"> 使用隔离机制时需要ssh无秘钥登录--&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;name&gt;</span><span style="color:#ff0000; font-family:等线; font-size:11pt">dfs.ha.fencing.ssh.private</span><span style="color:#ff0000; font-family:等线; font-size:11pt">-key-files&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;value&gt;/</span><span style="color:#ff0000; font-family:等线; font-size:11pt">root</span><span style="color:#ff0000; font-family:等线; font-size:11pt">/.ssh/id_rsa&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="color:#ff0000; font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 关闭权限检查--&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;</span><span style="font-family:等线; font-size:11pt">dfs.permissions</span><span style="font-family:等线; font-size:11pt">.enable&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;value&gt;false&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt"> 访问代理类：client，mycluster，active配置失败自动切换实现方式--&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">  </span><span style="width:14.97pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;name&gt;</span><span style="font-family:等线; font-size:11pt">dfs.client</span><span style="font-family:等线; font-size:11pt">.failover.proxy.provider.mycluster&lt;/name&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;value&gt;</span><span style="font-family:等线; font-size:11pt">org.apache</span><span style="font-family:等线; font-size:11pt">.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&lt;/configuration&gt;</span></p></td></tr></table><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">的树结构</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">有</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个，但对外要暴露统一的名称，还要分别设置通讯和</span><span style="font-family:等线; font-size:11pt">web</span><span style="font-family:宋体; font-size:11pt">地址</span></h6><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">JN</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">的地址放在</span><span style="font-family:等线; font-size:11pt">core</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">J</span><span style="font-family:等线; font-size:11pt">N</span><span style="font-family:宋体; font-size:11pt">的放在</span><span style="font-family:等线; font-size:11pt">hdfs-site.xml</span><span style="font-family:宋体; font-size:11pt">，因为</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">不仅</span><span style="font-family:等线; font-size:11pt">hdfs</span><span style="font-family:宋体; font-size:11pt">用，</span><span style="font-family:等线; font-size:11pt">jn</span><span style="font-family:宋体; font-size:11pt">只有</span><span style="font-family:等线; font-size:11pt">hdfs</span><span style="font-family:宋体; font-size:11pt">用。</span></h6><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">要谁是</span><span style="font-family:等线; font-size:11pt">Active</span><span style="font-family:宋体; font-size:11pt">不确定，所以要通过</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">同对方通信，所以要把</span><span style="font-family:等线; font-size:11pt">editslog</span><span style="font-family:宋体; font-size:11pt">的分享地址要设置为</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">的地址，保证内存数据的一致</span></h6><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.002.png" width="888" height="92" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(1)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">这个配文是要被管理脚本读取的，管理脚本读取后会开启JN节点然后将JN同2个NN联系</span></p><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(2)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">&lt;value&gt;</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">后面的/mycluster是在zk注册的节点(文件夹</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">)</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">的前缀，因为zk</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">不仅只给</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">一个集群用，为了防止不同集群信息覆盖，要给每个集群设置唯一的名字</span></p><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(3)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">JN就是journal</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">node</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{3}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">failover</span><span style="font-family:宋体; font-size:11pt">代理</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">因为</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">zkfc</span><span style="font-family:宋体; font-size:11pt">之间要相互调用，所以都要设置免密钥</span></h6><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(1)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">免密钥2个需求场景</span></p><p style="font-weight:normal; line-height:10.5pt; margin:0pt 0pt 0pt 105.85pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="color:#262626; font-family:'等线 Light'; font-size:10.5pt">1st</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="color:#262626; font-family:'等线 Light'; font-size:10.5pt">管理节点设置其他所有被管理节点的免密钥</span></p><p style="font-weight:normal; line-height:10.5pt; margin:0pt 0pt 0pt 105.85pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="color:#262626; font-family:'等线 Light'; font-size:10.5pt">2nd</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="color:#262626; font-family:'等线 Light'; font-size:10.5pt">2个NN之间相互设置，为了FC能相互调用降级方法</span></p><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">要设置回调方法和代理，由代理对象执行回调方法</span><span style="font-family:宋体; font-size:11pt"> </span></h6><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.3.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">配置完，格式化</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">+</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">启动</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">src</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">如果就一个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">，直接格式化即可</span></h6><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(1)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">格式化意味着重新构建一个集群，会有新的clusterID，会将已有的元数据(</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">data</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">和logs目录</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">)</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">清除，创建空的fsimage和edits，version，clusterID</span></p><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">但如果有</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">，如果同时格式化，会导致有</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">clusterID</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">DN</span><span style="font-family:宋体; font-size:11pt">不知道向谁汇报。</span></h6><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(1)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">设置了editslog的share目录，editslog存在JN集群种，需要先启动JN</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt"> </span></p><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(2)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">先启动一个NN，然后通过JN同步另外一个NN==</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">》</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">另外一个NN不需要格式化，也获取了集群的信息</span></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:78.75pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.003.png" width="1021" height="249" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(3)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">DN启动时，从ANN获取集群ID</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在各个</span><span style="font-family:等线; font-size:11pt">JournalNode</span><span style="font-family:宋体; font-size:11pt">节点上，输入以下命令启动</span><span style="font-family:等线; font-size:11pt">journalnode</span><span style="font-family:宋体; font-size:11pt">服务</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemon.sh start journalnode</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{3}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在</span><span style="font-family:等线; font-size:11pt">[</span><span style="font-family:等线; font-size:11pt">nn1</span><span style="font-family:等线; font-size:11pt">]</span><span style="font-family:宋体; font-size:11pt">上</span><span style="font-family:宋体; font-size:11pt">，对其进行格式化，并启动</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs namenode -format</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemon.sh start namenode</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{4}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在</span><span style="font-family:等线; font-size:11pt">[</span><span style="font-family:等线; font-size:11pt">nn2</span><span style="font-family:等线; font-size:11pt">]</span><span style="font-family:宋体; font-size:11pt">上</span><span style="font-family:宋体; font-size:11pt">，同步</span><span style="font-family:等线; font-size:11pt">nn1</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:宋体; font-size:11pt">元数据信息</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs namenode -bootstrapStandby</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{5}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">启动</span><span style="font-family:等线; font-size:11pt">[</span><span style="font-family:等线; font-size:11pt">nn2</span><span style="font-family:等线; font-size:11pt">]</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemon.sh start namenode</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{6}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">查看</span><span style="font-family:等线; font-size:11pt">web</span><span style="font-family:宋体; font-size:11pt">页面显示</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.004.png" width="363" height="120" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span style="font-family:等线; font-size:10.5pt"> </span><img src="70727358-ff2e-4485-b460-563acdddc33b.005.png" width="363" height="123" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{7}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在</span><span style="font-family:等线; font-size:11pt">[</span><span style="font-family:等线; font-size:11pt">nn1</span><span style="font-family:等线; font-size:11pt">]</span><span style="font-family:宋体; font-size:11pt">上</span><span style="font-family:宋体; font-size:11pt">，启动所有</span><span style="font-family:等线; font-size:11pt">datanode</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">      </span><span style="width:4.19pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemons.sh start datanode</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{8}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">将</span><span style="font-family:等线; font-size:11pt">[</span><span style="font-family:等线; font-size:11pt">nn1</span><span style="font-family:等线; font-size:11pt">]</span><span style="font-family:宋体; font-size:11pt">切换</span><span style="font-family:宋体; font-size:11pt">为</span><span style="font-family:等线; font-size:11pt">Active</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs haadmin -transitionToActive nn1</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{9}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">查看</span><span style="font-family:宋体; font-size:11pt">是否</span><span style="font-family:等线; font-size:11pt">Active</span></h5><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"><span style="width:10.5pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs haadmin -getServiceState nn1</span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{10}</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:11pt">手动</span><span style="font-family:等线; font-size:11pt">failover</span><span style="font-family:宋体; font-size:11pt">的命令</span></h5><p style="background-color:#ffffff; margin:6pt 0pt 6pt 73.5pt"><span style="font-family:宋体; font-size:10pt">Usage: haadmin</span></p><p style="background-color:#ffffff; margin:0pt 0pt 0pt 73.5pt"><span style="font-family:宋体; font-size:10pt">    [-transitionToActive &lt;serviceId&gt;]</span></p><p style="background-color:#ffffff; margin:0pt 0pt 0pt 73.5pt"><span style="font-family:宋体; font-size:10pt">    [-transitionToStandby &lt;serviceId&gt;]</span></p><p style="background-color:#ffffff; margin:0pt 0pt 0pt 73.5pt"><span style="font-family:宋体; font-size:10pt">    [-failover [--forcefence] [--forceactive] &lt;serviceId&gt; &lt;serviceId&gt;]</span></p><p style="background-color:#ffffff; margin:0pt 0pt 0pt 73.5pt"><span style="font-family:宋体; font-size:10pt">    [-getServiceState &lt;serviceId&gt;]</span></p><p style="background-color:#ffffff; margin:0pt 0pt 0pt 73.5pt"><span style="font-family:宋体; font-size:10pt">    [-checkHealth &lt;serviceId&gt;]</span></p><p style="background-color:#ffffff; margin:6pt 0pt 6pt 73.5pt"><span style="font-family:宋体; font-size:10pt">    [-help &lt;command&gt;]</span></p><p style="line-height:10.5pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">配置</span><span style="font-family:等线; font-size:11pt; font-weight:bold">HA</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">自动故障转移</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.4.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">节点设置免密钥</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">管理节点管理其他所有</span></h5><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.4.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">集群</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">安装配置</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">解压，在环境变量中添加</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">的信息，因为管理脚本需要调用和获取一些</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">的命令</span></h6><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><span style="font-family:等线; font-size:10.5pt">export JAVA_HOME=/opt/module/jdk</span></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><span style="font-family:等线; font-size:10.5pt">export HADOOP_HOME=/opt/module/hadoop-2.7.2</span></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><span style="font-family:等线; font-size:10.5pt">export ZOOKEEPER_HOME=/opt/module/zookeeper-3.4.10</span></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><span style="font-family:等线; font-size:10.5pt">export PATH=$JAVA_HOME/</span><span style="font-family:等线; font-size:10.5pt">bin:$</span><span style="font-family:等线; font-size:10.5pt">HADOOP_HOME/bin:$HADOOP_HOME/sbin:$ZOOKEEPER_HOME/bin:$PATH</span></p><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">将默认的</span><span style="font-family:等线; font-size:11pt">zoo-sample</span><span style="font-family:等线; font-size:11pt">.cfg</span><span style="font-family:宋体; font-size:11pt">改名为</span><span style="font-family:等线; font-size:11pt">zoo</span><span style="font-family:等线; font-size:11pt">.cfg</span><span style="font-family:宋体; font-size:11pt">，修改</span><span style="font-family:等线; font-size:11pt">dataDir</span><span style="font-family:宋体; font-size:11pt">，在下方加上集群的注册信息</span></h6><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(1)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">dataDir</span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">，唯一标识，ip，投票选举端口</span></p><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:91.75pt"><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:383.1pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">dataDir=/var/bd/hadoop/zk</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:404pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:383.1pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">server.1=</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">102:2888:3888</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">server.2=</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">103:2888:3888</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">server.3=</span><span style="font-family:等线; font-size:11pt">node</span><span style="font-family:等线; font-size:11pt">104:2888:3888</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:404pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt">此处是node2、3、4作为zk节点，所以从</span><span style="font-family:等线; font-size:11pt">102</span><span style="font-family:等线; font-size:11pt">开始</span></p></td></tr></table><p style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 91.65pt; page-break-after:avoid; page-break-inside:avoid; text-indent:0pt"><span style="font-family:'等线 Light'; font-size:11pt">(2)</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="color:#1f3864; font-family:'等线 Light'; font-size:11pt">logDir</span></p><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[3]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">在数据目录创建一个</span><span style="font-family:等线; font-size:11pt">myid</span><span style="font-family:宋体; font-size:11pt">文件，里面把</span><span style="font-family:等线; font-size:11pt">serverID</span><span style="font-family:宋体; font-size:11pt">写上，只写一个数字即可。</span></h6><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[4]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">scp</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">-r</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">源</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">目的地</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">·</span><span style="font-family:等线; font-size:11pt">pwd</span><span style="font-family:宋体; font-size:11pt">·</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">波浪号包裹的命令会先执行</span></h6><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">启动</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">zkServer</span><span style="font-family:等线; font-size:11pt">.sh </span><span style="font-family:等线; font-size:11pt">start  status</span></h6><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.4.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">core-site</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:77.6pt"><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:492.4pt"><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;configuration&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;!--</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt"> </span><span style="background-color:#efefef; font-family:宋体; font-size:11pt">指定</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">HDFS</span><span style="background-color:#efefef; font-family:宋体; font-size:11pt">中</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">NameNode</span><span style="background-color:#efefef; font-family:宋体; font-size:11pt">的地址</span><span style="background-color:#efefef; font-family:宋体; font-size:11pt"> </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;name&gt;</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">fs.defaultFS</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">    </span><span style="width:21.61pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;value&gt;hdfs://mycluster&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="font-family:Consolas; font-size:11pt">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;!--</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt"> </span><span style="background-color:#efefef; font-family:宋体; font-size:11pt">指定</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">Hadoop</span><span style="background-color:#efefef; font-family:宋体; font-size:11pt">运行时产生文件的存储目录</span><span style="background-color:#efefef; font-family:宋体; font-size:11pt"> </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;value&gt;/opt/module/hadoop-2.7.2/data/tmp&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt; text-indent:42pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">    </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">        </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;name&gt;</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">ha.zookeeper</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">.quorum&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">    </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">        </span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;value&gt;node</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">102:2181,node</span><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">103:2181,node104:2181&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt; text-indent:42pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="font-family:Consolas; font-size:11pt">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt">&lt;/configuration&gt;</span></p></td></tr></table><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.4.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hdfs-site</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:56.7pt"><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:874.75pt"><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; font-family:Consolas; font-size:11pt; font-weight:normal">&lt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;configuration&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">      &lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">dfs.replication</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;2&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">完全分布式集群名称</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">dfs.nameservices</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;mycluster&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">集群中</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">NameNode</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">节点都有哪些</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">ha.namenodes</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">.mycluster&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;nn</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">1,nn</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">2&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> nn1</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">的</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">RPC</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">通信地址</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.namenode.rpc-address.mycluster.nn1&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;node101:9000&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> nn2</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">的</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">RPC</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">通信地址</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.namenode.rpc-address.mycluster.nn2&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;node102:9000&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> nn1</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">的</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">http</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">通信地址</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.namenode.http-address.mycluster.nn1&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;node101:50070&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> nn2</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">的</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">http</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">通信地址</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.namenode.http-address.mycluster.nn2&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;node102:50070&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">指定</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">NameNode</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">元数据在</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">JournalNode</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">上的存放位置</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">    &lt;value&gt;qjournal://node101:8485;node102:8485;node103:8485/mycluster&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">声明</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">journalnode</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">服务器存储目录</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;/opt/module/hadoop-2.7.2/data/jn&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">启动自动代理</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">    &lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">        &lt;name&gt;dfs.</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">ha.automatic</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">-failover.enabled&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">        &lt;value&gt;true&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">    &lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">配置隔离机制，即同一时刻只能有一台服务器对外响应</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;dfs.</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">ha.fencing</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">.methods&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;sshfence&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">使用隔离机制时需要</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">ssh</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">无秘钥登录</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">dfs.ha.fencing.ssh.private</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">-key-files&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;/root/.ssh/id_rsa&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">关闭权限检查</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">dfs.permissions</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">.enable&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;false&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&#xa0;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;!--</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold"> </span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">访问代理类：</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">client</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">，</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">mycluster</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">，</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">active</span><span style="background-color:#efefef; color:#000080; font-family:宋体; font-size:11pt; font-weight:bold">配置失败自动切换实现方式</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">--&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">  </span><span style="width:33.7pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:91.6pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;name&gt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">dfs.client</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">.failover.proxy.provider.mycluster&lt;/name&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">    </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">    </span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;value&gt;</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">org.apache</span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt"><span style="width:45.8pt; text-indent:0pt; display:inline-block; -aw-tabstop-align:left; -aw-tabstop-pos:45.8pt"></span><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/property&gt;</span></p><p style="background-color:#c9efcb; line-height:11pt; margin:0pt; text-indent:21pt"><span style="background-color:#efefef; color:#000080; font-family:Consolas; font-size:11pt; font-weight:bold">&lt;/configuration&gt;</span></p></td></tr></table><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">将</span><span style="font-family:等线; font-size:11pt">SNN</span><span style="font-family:宋体; font-size:11pt">的配置删除，因为已经有了双</span><span style="font-family:等线; font-size:11pt">NN</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">官网说</span><span style="font-family:宋体; font-size:11pt">第二个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">也可以做</span><span style="font-family:等线; font-size:11pt">SNN</span><span style="font-family:宋体; font-size:11pt">的工作</span></h6><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:73.5pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.006.png" width="910" height="45" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.007.png" width="445" height="75" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">启动故障转移</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.008.png" width="483" height="102" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.5</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">此时</span><span style="font-family:等线; font-size:11pt; font-weight:bold">H</span><span style="font-family:等线; font-size:11pt; font-weight:bold">A</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">自动故障转移配置已经完成，开始手动启动</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">启动</span><span style="font-family:等线; font-size:11pt">zk</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="color:#ff0000; font-family:宋体; font-size:11pt">启动</span><span style="color:#ff0000; font-family:等线; font-size:11pt">JN</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:6pt 0pt 6pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">启动</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">会自动创建</span><span style="font-family:等线; font-size:11pt">data</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">logs</span><span style="font-family:宋体; font-size:11pt">，因为</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">的目录也是设置在</span><span style="font-family:等线; font-size:11pt">data</span><span style="font-family:宋体; font-size:11pt">下</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:6pt 0pt 6pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在</span><span style="font-family:等线; font-size:11pt">1</span><span style="font-family:宋体; font-size:11pt">、</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">、</span><span style="font-family:等线; font-size:11pt">3</span><span style="font-family:宋体; font-size:11pt">启动</span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:等线; font-size:11pt"> </span><img src="70727358-ff2e-4485-b460-563acdddc33b.009.png" width="555" height="24" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></h5><h6 style="font-weight:normal; margin:6pt 0pt 6pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">hadoop-daemon.sh start journalnode</span></h6><h5 style="font-weight:normal; line-height:11pt; margin:6pt 0pt 6pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{3}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">JN</span><span style="font-family:宋体; font-size:11pt">通过</span><span style="font-family:等线; font-size:11pt">java</span><span style="font-family:宋体; font-size:11pt">编写，通过</span><span style="font-family:等线; font-size:11pt">jps</span></h5><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">格式化</span><span style="font-family:等线; font-size:11pt">zk</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">节点上创建</span><span style="font-family:等线; font-size:11pt">hadoop</span><span style="font-family:宋体; font-size:11pt">的节点，只需要在第一次时执行。启动</span><span style="font-family:等线; font-size:11pt">zkFC</span><span style="font-family:宋体; font-size:11pt">之后</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">在这个目录下争抢锁，决定谁是</span><span style="font-family:等线; font-size:11pt">Active</span></h5><h6 style="font-weight:normal; margin:6pt 0pt 6pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">格式化</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">节点，这一步跟</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">启动无先后顺序</span></h6><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.010.png" width="819" height="137" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">先启动</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">集群</span></h6><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hdfs zkfc -formatZK </span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.011.png" width="434" height="38" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.012.png" width="704" height="173" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span style="font-family:等线; font-size:10.5pt"> </span></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{3}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">此时通过</span><span style="font-family:等线; font-size:11pt">zkCli</span><span style="font-family:宋体; font-size:11pt">去查看</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">的树形目录，会发现有</span><span style="font-family:等线; font-size:11pt">hadoop-ha</span><span style="font-family:宋体; font-size:11pt">节点，如果里面的内容为</span><span style="font-family:宋体; font-size:11pt">空说明</span><span style="font-family:宋体; font-size:11pt">格式化完成</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.013.png" width="544" height="81" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><img src="70727358-ff2e-4485-b460-563acdddc33b.014.png" width="495" height="153" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.015.png" width="213" height="93" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">手动选一个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">节点，格式化。然后启动这个</span><span style="font-family:等线; font-size:11pt">NN</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:63pt"><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:404pt"><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt"># 格式化集群的 NameNode (在 node-1 上执行)</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">$ hdfs namenode </span><span style="color:#67cdcc; font-family:等线; font-size:11pt">-</span><span style="color:#cccccc; font-family:等线; font-size:11pt">format</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt"># 启动刚格式化的 NameNode (在 node-1 上执行)</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">$ hdfs</span><span style="color:#67cdcc; font-family:等线; font-size:11pt">-</span><span style="color:#cccccc; font-family:等线; font-size:11pt">daemon start namenode</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt"># 同步 NameNode1 元数据到 NameNode2 上 (在 node-2 上执行)  </span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">$ hdfs namenode </span><span style="color:#67cdcc; font-family:等线; font-size:11pt">-</span><span style="color:#cccccc; font-family:等线; font-size:11pt">bootstrapStandby</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:0pt"><span style="font-family:等线; font-size:11pt"># 启动 NameNode2 (在 node-2 上执行)</span></p><p style="line-height:11pt; margin:0pt"><span style="color:#cccccc; font-family:等线; font-size:11pt">$ hdfs</span><span style="color:#67cdcc; font-family:等线; font-size:11pt">-</span><span style="color:#cccccc; font-family:等线; font-size:11pt">daemon start namenode</span></p></td></tr></table><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hadoop</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">namenode</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">-format</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hadoop-daemon.sh start namenode</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.016.png" width="903" height="84" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.5</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">启动另外一个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">，要通过专门的</span><span style="font-family:等线; font-size:11pt">standby</span><span style="font-family:宋体; font-size:11pt">命令启动</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hdfs namenode -bootstrapStandby</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">hadoop-daemon.sh start namenode</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:等线; font-size:11pt">hdfs namenode -bootstrapStandby</span><span style="font-family:宋体; font-size:11pt">并不会启动只是同步</span></h6><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[2]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">一定要关防火墙</span></h6><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:105pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.017.png" width="497" height="279" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.6</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">手动启动</span><span style="font-family:等线; font-size:11pt">zkfc</span><span style="font-family:宋体; font-size:11pt">，不然</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个都是</span><span style="font-family:等线; font-size:11pt">standby</span><span style="font-family:宋体; font-size:11pt">，</span><span style="font-family:等线; font-size:11pt">start-dfs</span><span style="font-family:等线; font-size:11pt">.sh</span><span style="font-family:宋体; font-size:11pt">会把</span><span style="font-family:等线; font-size:11pt">zkfc</span><span style="font-family:宋体; font-size:11pt">一起启动</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.5.7</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">手动启动</span><span style="font-family:等线; font-size:11pt">DNs</span></h4><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.6</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">使用</span><span style="font-family:等线; font-size:11pt; font-weight:bold">start-dfs</span><span style="font-family:等线; font-size:11pt; font-weight:bold">.sh</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">自动启动</span><span style="font-family:等线; font-size:11pt; font-weight:bold">hadoop</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">集群</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.018.png" width="890" height="216" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.6.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">如果把</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">关掉在启动，会发现</span><span style="font-family:等线; font-size:11pt">2</span><span style="font-family:宋体; font-size:11pt">个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">都是</span><span style="font-family:等线; font-size:11pt">Standby</span><span style="font-family:宋体; font-size:11pt">，没有</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">，因为没有</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">协调</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.6.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">test</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">node101</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.019.png" width="269" height="81" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">idea</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">zkGUI</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.020.png" width="427" height="108" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.7</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">testHA</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.7.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">nn</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">将</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">kill</span><span style="font-family:宋体; font-size:11pt">，然后再去</span><span style="font-family:等线; font-size:11pt">GUI</span><span style="font-family:宋体; font-size:11pt">页面查看，会发现原来</span><span style="font-family:等线; font-size:11pt">Standby</span><span style="font-family:宋体; font-size:11pt">的变成了</span><span style="font-family:等线; font-size:11pt">active</span></h5><h6 style="font-weight:normal; margin:0pt 0pt 0pt 70.9pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">[1]</span><span style="font:7.0pt 'Times New Roman'"> </span><span style="font-family:宋体; font-size:11pt">如果再把原来的</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">恢复，</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">不变，</span><span style="font-family:宋体; font-size:11pt">新恢复</span><span style="font-family:宋体; font-size:11pt">的变为</span><span style="font-family:等线; font-size:11pt">standby</span></h6><p style="line-height:10.5pt; margin:7.8pt 0pt 7.8pt 84pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.021.png" width="900" height="55" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">在</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">的节点系统中通过</span><span style="font-family:等线; font-size:11pt">ls</span><span style="font-family:宋体; font-size:11pt">查看，也可以观察到</span><span style="font-family:等线; font-size:11pt">mycluster</span><span style="font-family:宋体; font-size:11pt">节点下</span><span style="font-family:宋体; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">节点发生变化</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{3}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">idea</span><span style="font-family:宋体; font-size:11pt">中的</span><span style="font-family:等线; font-size:11pt">zkGUI</span></h5><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:94.5pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.022.png" width="414" height="91" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.7.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">zkFC</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">kill</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:宋体; font-size:11pt">当前</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">fc</span><span style="font-family:等线; font-size:11pt">  </span><span style="font-family:等线; font-size:11pt">kill</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">-9</span><span style="font-family:等线; font-size:11pt"> </span><span style="font-family:等线; font-size:11pt">pid</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">变成</span><span style="font-family:等线; font-size:11pt">standby</span><span style="font-family:宋体; font-size:11pt">，原来的</span><span style="font-family:等线; font-size:11pt">S</span><span style="font-family:宋体; font-size:11pt">变为</span><span style="font-family:等线; font-size:11pt">A</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{3}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">将</span><span style="font-family:等线; font-size:11pt">zkFC</span><span style="font-family:宋体; font-size:11pt">进程重启。</span><span style="font-family:等线; font-size:11pt">hadoop-daemon.sh start zkfc</span></h5><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{4}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">zkFC</span><span style="font-family:宋体; font-size:11pt">被</span><span style="font-family:等线; font-size:11pt">kill</span><span style="font-family:宋体; font-size:11pt">，会导致</span><span style="font-family:等线; font-size:11pt">active</span><span style="font-family:宋体; font-size:11pt">的切换，重启后，不会有影响，</span><span style="font-family:等线; font-size:11pt">zkFC</span><span style="font-family:宋体; font-size:11pt">仅仅是个监控环境的</span></h5><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">1.8</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">note</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">如果没设置主机名，</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">DN</span><span style="font-family:宋体; font-size:11pt">列表会显示不全</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">如果</span><span style="font-family:等线; font-size:11pt">HA</span><span style="font-family:宋体; font-size:11pt">时</span><span style="font-family:等线; font-size:11pt">core-site</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:等线; font-size:11pt">defaultFs</span><span style="font-family:宋体; font-size:11pt">没有</span><span style="font-family:宋体; font-size:11pt">写统一</span><span style="font-family:宋体; font-size:11pt">的名称而仅仅写了一个节点的地址，会导致一个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">启动另一个</span><span style="font-family:等线; font-size:11pt">NN</span><span style="font-family:宋体; font-size:11pt">直接关闭</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">修改配置后要重新格式化</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">和</span><span style="font-family:等线; font-size:11pt">NN</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">SSH</span><span style="font-family:宋体; font-size:11pt">勿忘把自己的公</span><span style="font-family:宋体; font-size:11pt">钥</span><span style="font-family:宋体; font-size:11pt">复制给自己</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">1.8.5</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">rsync</span><span style="font-family:宋体; font-size:11pt">的脚本名字一定不能是</span><span style="font-family:等线; font-size:11pt">rsync</span><span style="font-family:宋体; font-size:11pt">，会死循环。脚本循环执行时，节点不要写多了，虽然不报错，但</span><span style="font-family:宋体; font-size:11pt">不</span><span style="font-family:宋体; font-size:11pt">优雅</span></h4><h2 style="margin:0pt 0pt 6pt 20.75pt; text-indent:0pt"><span style="font-family:等线; font-size:14pt; font-style:normal">2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">yarn</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span><span style="font-family:等线; font-size:11pt; font-weight:bold">HA</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">的原理和搭建</span></h2><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">2.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">src</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">2.1.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">原理同</span><span style="font-family:等线; font-size:11pt">hdfs</span><span style="font-family:宋体; font-size:11pt">的不同，利用</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">监控另一个</span><span style="font-family:等线; font-size:11pt">RM</span><span style="font-family:宋体; font-size:11pt">的状态，但没有</span><span style="font-family:等线; font-size:11pt">zkFC</span><span style="font-family:宋体; font-size:11pt">，直接依赖</span><span style="font-family:等线; font-size:11pt">zk</span><span style="font-family:宋体; font-size:11pt">，</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">2.1.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">官方文档：</span></h4><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 42pt; text-indent:21pt"><a style="color:#0563c1" href="http://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-site/ResourceManagerHA.html"><span style="color:#0563c1; font-family:等线; font-size:10.5pt; text-decoration:underline">http://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-site/ResourceManagerHA.html</span></a></p><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">2.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt; font-weight:bold">Y</span><span style="font-family:等线; font-size:11pt; font-weight:bold">ARN-HA</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">工作</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">机制</span></h3><p style="line-height:10.5pt; margin:7.8pt 0pt; text-indent:63pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.023.png" width="418" height="237" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">2.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">配置</span><span style="font-family:等线; font-size:11pt; font-weight:bold">YARN</span><span style="font-family:等线; font-size:11pt; font-weight:bold">-HA</span><span style="font-family:宋体; font-size:11pt; font-weight:bold">集群</span></h3><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">2.3.1</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">环境</span><span style="font-family:宋体; font-size:11pt">准备</span></h4><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">2.3.2</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">规划集群</span></h4><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:0pt"><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">hadoop102 </span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">hadoop103  </span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">hadoop104</span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">NameNode</span><span style="width:8.28pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">NameNode</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">JournalNode</span><span style="width:2.85pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">JournalNode</span><span style="width:2.85pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">JournalNode</span><span style="width:2.85pt; text-indent:0pt; display:inline-block"></span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">DataNode</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">DataNode</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">DataNode</span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">ZK</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">ZK</span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">ZK</span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">ResourceManager</span><span style="width:19.53pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">ResourceManager</span><span style="width:19.53pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">&#xa0;</span></p></td></tr><tr><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.2pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">NodeManager</span><span style="width:15.43pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt; vertical-align:4pt">NodeManager</span><span style="width:15.43pt; text-indent:0pt; display:inline-block"></span></p></td><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:131.25pt"><p style="line-height:11pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:11pt">NodeManager</span><span style="width:15.43pt; text-indent:0pt; display:inline-block"></span></p></td></tr></table><h4 style="font-weight:normal; margin:0pt 0pt 6pt 49.15pt; text-indent:0pt"><span style="display:inline; font-family:等线; font-size:11pt; font-style:normal; font-variant:normal; text-decoration:none; text-transform:none; vertical-align:baseline">2.3.3</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">具体配置</span></h4><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{1}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:等线; font-size:11pt">yarn-site.xml</span></h5><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:5.4pt"><tr><td style="padding-left:5.4pt; padding-right:5.4pt; vertical-align:top; width:400.3pt"><table cellspacing="0" cellpadding="0" style="border-collapse:collapse; margin-left:60pt; width:632.95pt"><tr style="height:639.85pt"><td style="border-bottom-color:#000000; border-bottom-style:solid; border-bottom-width:0.75pt; border-left-color:#000000; border-left-style:solid; border-left-width:0.75pt; border-right-color:#000000; border-right-style:solid; border-right-width:0.75pt; border-top-color:#000000; border-top-style:solid; border-top-width:0.75pt; padding-left:5.03pt; padding-right:5.03pt; vertical-align:top; width:621.4pt"><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&lt;configuration&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt">启用resourcemanager ha--&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;</span><span style="font-family:等线; font-size:11pt">yarn.resourcemanager</span><span style="font-family:等线; font-size:11pt">.ha.enabled&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;true&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt">声明两台resourcemanager的地址--&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;</span><span style="font-family:等线; font-size:11pt">yarn.resourcemanager</span><span style="font-family:等线; font-size:11pt">.cluster-id&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;cluster-yarn1&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;rm</span><span style="font-family:等线; font-size:11pt">1,rm</span><span style="font-family:等线; font-size:11pt">2&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;hadoop102&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;hadoop103&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt">指定zookeeper集群的地址--&gt; </span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;</span><span style="font-family:等线; font-size:11pt">yarn.resourcemanager</span><span style="font-family:等线; font-size:11pt">.zk-address&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;hadoop</span><span style="font-family:等线; font-size:11pt">102:2181,hadoop</span><span style="font-family:等线; font-size:11pt">103:2181,hadoop104:2181&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt">启用自动恢复--&gt; </span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;</span><span style="font-family:等线; font-size:11pt">yarn.resourcemanager</span><span style="font-family:等线; font-size:11pt">.recovery.enabled&lt;/name&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">        &lt;value&gt;true&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    </span><span style="font-family:等线; font-size:11pt">&lt;!--</span><span style="font-family:等线; font-size:11pt">指定resourcemanager的状态信息存储在zookeeper集群--&gt; </span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">    &lt;property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt 2.5pt 21pt; padding-left:42pt; text-indent:-42pt"><span style="font-family:等线; font-size:11pt">        &lt;name&gt;</span><span style="font-family:等线; font-size:11pt">yarn.resourcemanager</span><span style="font-family:等线; font-size:11pt">.store.class&lt;/name&gt;     &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore&lt;/value&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&lt;/property&gt;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&#xa0;</span></p><p style="line-height:11pt; margin:2.5pt 0pt; text-indent:22pt"><span style="font-family:等线; font-size:11pt">&lt;/configuration&gt;</span></p></td></tr></table><p style="background-color:#e0e0e0; line-height:8pt; margin:7.8pt 0pt 7.8pt 31.5pt; orphans:0; text-align:justify; widows:0"></p></td></tr></table><h5 style="font-weight:normal; line-height:11pt; margin:0pt 0pt 0pt 63.3pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt">{2}</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt">同步更新</span><span style="font-family:宋体; font-size:11pt">其他节点</span><span style="font-family:宋体; font-size:11pt">的</span><span style="font-family:宋体; font-size:11pt">配置信息</span></h5><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">2.4</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">启动</span><span style="font-family:等线; font-size:11pt; font-weight:bold">hdfs</span><span style="font-family:等线; font-size:11pt; font-weight:bold"> </span></h3><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 52.5pt"><span style="font-family:等线; font-size:10.5pt">（1）</span><span style="font-family:等线; font-size:10.5pt">在各个JournalNode节点上，输入以下命令启动journalnode服务：</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemon.sh start journalnode</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 52.5pt"><span style="font-family:等线; font-size:10.5pt">（2）在[</span><span style="font-family:等线; font-size:10.5pt">nn1</span><span style="font-family:等线; font-size:10.5pt">]上</span><span style="font-family:等线; font-size:10.5pt">，对其进行格式化，并启动：</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs namenode -format</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemon.sh start namenode</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 52.5pt"><span style="font-family:等线; font-size:10.5pt">（3）在[</span><span style="font-family:等线; font-size:10.5pt">nn2</span><span style="font-family:等线; font-size:10.5pt">]上</span><span style="font-family:等线; font-size:10.5pt">，同步nn1</span><span style="font-family:等线; font-size:10.5pt">的</span><span style="font-family:等线; font-size:10.5pt">元数据信息：</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs namenode -bootstrapStandby</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 52.5pt"><span style="font-family:等线; font-size:10.5pt">（4）启动[</span><span style="font-family:等线; font-size:10.5pt">nn2</span><span style="font-family:等线; font-size:10.5pt">]：</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemon.sh start namenode</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 52.5pt"><span style="font-family:等线; font-size:10.5pt">（5）</span><span style="font-family:等线; font-size:10.5pt">启动所有DataNode</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">sbin/hadoop-daemons.sh start datanode</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 52.5pt"><span style="font-family:等线; font-size:10.5pt">（6）将[</span><span style="font-family:等线; font-size:10.5pt">nn1</span><span style="font-family:等线; font-size:10.5pt">]切换</span><span style="font-family:等线; font-size:10.5pt">为Active</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 63pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">bin/hdfs haadmin -transitionToActive nn1</span></p><h3 style="margin:0pt 0pt 6pt 34.95pt; text-indent:0pt"><span style="font-family:等线; font-size:11pt; font-style:normal">2.5</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:11pt; font-weight:bold">启动</span><span style="font-family:等线; font-size:11pt; font-weight:bold">YARN </span></h3><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 34.95pt; text-indent:21pt"><span style="background-color:#ffffff; color:#2f2f2f; font-family:等线; font-size:10.5pt">（1）在</span><span style="background-color:#ffffff; color:#2f2f2f; font-family:等线; font-size:10.5pt">hadoop1</span><span style="background-color:#ffffff; color:#2f2f2f; font-family:等线; font-size:10.5pt">02中执行：</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 66.45pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">sbin/start-yarn.sh</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 34.95pt; text-indent:21pt"><span style="background-color:#ffffff; color:#2f2f2f; font-family:等线; font-size:10.5pt">（2）在</span><span style="background-color:#ffffff; color:#2f2f2f; font-family:等线; font-size:10.5pt">hadoop103</span><span style="background-color:#ffffff; color:#2f2f2f; font-family:等线; font-size:10.5pt">中执行：</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 66.45pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">sbin/yarn-daemon.sh start resourcemanager</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt 7.8pt 34.95pt; text-indent:21pt"><span style="background-color:#ffffff; font-family:等线; font-size:10.5pt">（3）查看服务状态，如图3-24所示</span></p><p style="background-color:#e0e0e0; line-height:11pt; margin:7.8pt 0pt 7.8pt 66.45pt; orphans:0; text-align:justify; widows:0"><span style="font-family:'Courier New'; font-size:10.5pt">bin/yarn rmadmin -getServiceState rm1</span></p><p style="font-size:10.5pt; line-height:150%; margin:7.8pt 0pt; text-indent:63pt"><img src="70727358-ff2e-4485-b460-563acdddc33b.024.png" width="555" height="179" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="line-height:10.5pt; margin:7.8pt 0pt"><span style="font-family:等线; font-size:10.5pt">&#xa0;</span></p></div></body></html>